{"triggers":[],"nodes":[{"uid":"31952630-c848-4049-a142-5460ba0d9b43","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"d548aab5-09a1-4446-ad20-3c12d261770f","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"61bef9e6-6de9-446b-b5e3-ef4ea1259000","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"#########################################################################################"}}]},{"uid":"b57d8550-3083-4b68-a6ea-16545880a7c5","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"_________________ 1. SCRIPT NAME __________________"}}]},{"uid":"18528c47-9ba5-4c2b-864a-6f3b64be3eb5","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Input file is not latest"}}]},{"uid":"2e44fbcb-bde8-4bf9-899b-290e733f5cbb","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"_________________ 2. PURPOSE __________________"}}]},{"uid":"22f77d7e-dfbe-4e4b-a263-4329cefebafa","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"To notify the status of the current processing to Ops team"}}]},{"uid":"f4928a78-da61-47ff-bc09-13e9dbfd3213","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"_________________ 3. IMPLEMENTATION __________________"}}]},{"uid":"c5893782-041f-415d-bcfb-d75194a4b64a","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"BOT will send notification to Ops team on the current processing"}}]},{"uid":"43798211-e126-44a5-97c7-cd9e33d5517b","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"In case of failure while finding/entering to a field, ERROR flag will be raised and BOT will show 'Untimed message box' and on clicking 'Ok' button, main BOT will stop itself"}}]},{"uid":"04a99374-23bc-4445-ab6d-211e815a1137","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":" "}}]},{"uid":"17323e37-4e5c-4e9f-a42f-9bde31d58630","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"#########################################################################################"}}]},{"uid":"a65d7514-f2af-4adc-9180-01dc501f5e9f","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Email.FileNotLatest"}}],"returnTo":{"type":"VARIABLE","variableName":"BOTNAME"}},{"uid":"f64c1635-51bf-4ad4-a8ee-91f44b18a08f","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$BOTNAME.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"BOTNAME"}},{"uid":"20a1aa8a-0144-4aaf-a06e-dc222f940720","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"#########################################################################################"}}]},{"uid":"ad478221-b562-4242-b6e9-2002973f3f11","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"################### INIT  ###################"}}]},{"uid":"8795d98f-9ffb-45c9-ae12-3b6f6858e559","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"#########################################################################################"}}]},{"uid":"f4c7824b-3d2d-4ee5-a27c-f0d58060a95c","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",\"INFO\",\"$BOTNAME$\",\"START\",\"\",\"\",\"\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"99f42851-e1f0-4876-8c65-5d035ac86192","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"#> Notify"}}]},{"uid":"a2c97385-b21b-4c0d-8015-eb9be3ebc6e2","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Tasks/KCTWildfireMoratorium/Configuration/ReadConfig.Email"},"taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"varBOTEmailAddr","value":{"type":"STRING","expression":"$varBOTEmailAddr$"}},{"key":"varErrorStatus","value":{"type":"STRING","expression":"$varErrorStatus$"}},{"key":"varFileNotLatestEmailBody","value":{"type":"STRING","expression":"$varFileNotLatestEmailBody$"}},{"key":"varFileNotLatestEmailSubject","value":{"type":"STRING","expression":"$varFileNotLatestEmailSubject$"}},{"key":"varOpsTeamEmailAddr","value":{"type":"STRING","expression":"$varOpsTeamEmailAddr$"}},{"key":"varRPAPRODEmailAddress","value":{"type":"STRING","expression":"$varRPAPRODEmailAddress$"}}]},"taskbotOutput":{"type":"DICTIONARY","dictionary":[]}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"varBOTEmailAddr","value":{"type":"VARIABLE","variableName":"varBOTEmailAddr"}},{"key":"varErrorStatus","value":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"key":"varFileNotLatestEmailBody","value":{"type":"VARIABLE","variableName":"varFileNotLatestEmailBody"}},{"key":"varFileNotLatestEmailSubject","value":{"type":"VARIABLE","variableName":"varFileNotLatestEmailSubject"}},{"key":"varOpsTeamEmailAddr","value":{"type":"VARIABLE","variableName":"varOpsTeamEmailAddr"}},{"key":"varRPAPRODEmailAddress","value":{"type":"VARIABLE","variableName":"varRPAPRODEmailAddress"}}]}},{"uid":"5c967f69-a03d-4bef-b412-03e20b8680b4","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varFileNotLatestEmailBody$"}},{"name":"find","value":{"type":"STRING","string":"%%"}},{"name":"replaceWith","value":{"type":"STRING","string":"<"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"varFileNotLatestEmailBody"}},{"uid":"dae0a64a-c9fd-4f91-9738-4b9dfb533538","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varFileNotLatestEmailBody$"}},{"name":"find","value":{"type":"STRING","string":"$$"}},{"name":"replaceWith","value":{"type":"STRING","string":">"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"varFileNotLatestEmailBody"}},{"uid":"baabcb33-5891-45ba-ba18-10f6aa878e5f","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varFileNotLatestEmailBody$"}},{"name":"find","value":{"type":"STRING","string":"ambsdnbsp"}},{"name":"replaceWith","value":{"type":"STRING","string":"&nbsp"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"varFileNotLatestEmailBody"}},{"uid":"2e81017a-8279-4b5b-a2e9-aa2006fd1f76","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$varOpsTeamEmailAddr$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","expression":"$varFileNotLatestEmailSubject$"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"HTML"}},{"name":"message","value":{"type":"STRING","expression":"<FONT face=Arial>$varFileNotLatestEmailBody$</FONT>"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$varBOTEmailAddr$"}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]},{"uid":"4bb278d7-f9cf-40a4-b4c3-fce176a47f3a","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",\"INFO\",\"$BOTNAME$\",\"File is not latest notification was sent successfully\",\"\",\"\",\"\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"92ff52e8-f8d7-41a9-925c-f8b01c2728ee","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"cdbcf8c8-a6b7-4418-839e-8cd562dcc4cf","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}},{"uid":"cbeba4c4-6adf-4475-8e96-45fea5191eb6","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"True"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"uid":"207cc4bb-7efb-4257-8058-40193d26dbb5","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorStatus.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorStatus"}}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}}}]}],"branches":[{"uid":"4296ca6c-da94-4e3c-a528-39b38a673e77","commandName":"finally","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"eafe2a99-4ca9-49f6-96f7-8d7f86d383da","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$Error-Description$\n$Error-LineNumber.Number:toString$\nEmail.FileNotLatest"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"6636c966-6988-4023-a58f-ddcc8180e2fc","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"04b9ff85-b408-49db-9923-84c41d4db20c","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"message","value":{"type":"STRING","expression":"$Error-Description$ Exception occurred at line number $Error-LineNumber.Number:toString$. You chose to mark the bot as 'Failed' in case of any encountered errors."}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$M-IsBotExecutedSuccessfully.Boolean:toString$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"false"}}],"value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"}}]}]}]}],"variables":[{"name":"Prompt-Assignment","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"Test-Value"}},{"name":"my-list-variable","description":"","type":"LIST","subtype":"STRING","input":true,"output":true,"defaultValue":{"type":"LIST","list":[{"type":"STRING","string":"my-value-1"},{"type":"STRING","string":"my-value-2"},{"type":"STRING","string":"my-value-3"},{"type":"STRING","string":"my-value-4"},{"type":"STRING","string":"my-value-5"}]}},{"name":"varErrorStatus","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"BOTNAME","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varLogFilePath","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varBOTEmailAddr","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varFileNotLatestEmailSubject","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varOpsTeamEmailAddr","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varFileNotLatestEmailBody","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varRPAPRODEmailAddress","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"M-IsBotExecutedSuccessfully","description":"","type":"BOOLEAN","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":"true"}},{"name":"Error-Description","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-LineNumber","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.1.0-20210722-143718"},{"name":"Comment","version":"2.7.0-20210722-143743"},{"name":"Email","version":"3.7.1-20210831-091101"},{"name":"ErrorHandler","version":"2.7.0-20210722-143834"},{"name":"If","version":"3.0.0-20210722-143856"},{"name":"LegacyAutomation","version":"4.4.0-20210803-013138"},{"name":"LogToFile","version":"3.1.0-20210722-144333"},{"name":"MessageBox","version":"3.0.0-20210722-144335"},{"name":"Number","version":"3.1.1-20210821-042642"},{"name":"String","version":"4.3.0-20210722-144812"},{"name":"TaskBot","version":"2.1.0-20210716-100552"}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"1","improvedNumberSupport":true,"timeout":"0s","automationPriority":"PRIORITY_LOW"}}