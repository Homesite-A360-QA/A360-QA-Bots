{"triggers":[],"nodes":[{"uid":"09ec84f6-16e4-47e3-9d6f-a3498ccd4948","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"536667ef-c024-4c2b-a86e-0f166f846e28","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"33d00056-647a-4ad5-bf1b-a617a98fa0ae","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"#########################################################################################"}}]},{"uid":"841d8f11-06f2-4bc2-8972-7e9e68107a51","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"_________________ 1. SCRIPT NAME __________________"}}]},{"uid":"9107ec9e-aed6-497b-9329-506752041f83","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Util.TakeScreenshots"}}]},{"uid":"0815a0e8-676c-4352-8d81-3beb26e16441","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"_________________ 2. PURPOSE __________________"}}]},{"uid":"146ebba9-834f-4b07-b05e-ed913f4410dd","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Will take a screenshot and store it under Logs\\ErrorScreenshots\\$ErrorRemarks$\\$timestamp$.png"}}]},{"uid":"b1126d9d-5a18-4097-80c3-be5208baad6a","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"_________________ 3. IMPLEMENTATION __________________"}}]},{"uid":"815cbcb5-9e84-4ffb-bd3b-b621c37d9db0","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":" "}}]},{"uid":"90555c57-977f-4025-8ecc-7394df4938b0","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"#########################################################################################"}}]},{"uid":"7783dd81-c90b-41dc-b34c-ec3410949567","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varLogFileAbsolutePath$"}},{"name":"find","value":{"type":"STRING","string":"log.csv$"}},{"name":"replaceWith","value":{"type":"STRING","string":""}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorScrnShotsFldr"}},{"uid":"7199c33e-9cb5-4d49-90ff-da460b114676","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorScrnShotsFldr$ErrorScreenshots"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorScrnShotsFldr"}},{"uid":"15d5fd0d-f98f-4751-9b95-6771c10d13b0","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorScrnShotsFldr.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorScrnShotsFldr"}},{"uid":"63757ef7-d2e2-4ac2-acb2-2ed83e48ae74","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"5b86c75e-3a7c-4471-8c8f-8242b9d654c4","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$varErrorScrnShotsFldr$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$varErrorScrnShotsFldr$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"d5b8950c-07de-4e1e-8706-e42ecf14d348","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"01eda45e-d5f7-49e3-b417-64a78b27f04b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorScrnShotsFldr$\\BLANK"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorScrnShotsFldr"}},{"uid":"64034f7d-0b5f-4aac-a378-5fb241d693cf","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorScrnShotsFldr.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorScrnShotsFldr"}}],"branches":[{"uid":"bab7a3a1-4e21-47f1-bba7-3b5c305426dd","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"f06b645e-1c3b-42d7-aa54-8a9a5be79824","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorRemarks$"}},{"name":"find","value":{"type":"STRING","string":"[\\\\/:*?\"'<>|]"}},{"name":"replaceWith","value":{"type":"STRING","string":""}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorRemarks1"}},{"uid":"5127a94b-a223-44d7-8ae4-f4e2e7433026","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorScrnShotsFldr$\\$varErrorRemarks1$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorScrnShotsFldr"}},{"uid":"aeed91b1-9cc6-487a-a380-ddf581f4c80c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorScrnShotsFldr.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorScrnShotsFldr"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$varErrorRemarks$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":""}}],"value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"}}]},{"uid":"575e4d8d-3d75-450f-8528-85d9edd834e5","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"236c37fb-6232-4044-b383-bae2df27af46","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$varErrorScrnShotsFldr$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$varErrorScrnShotsFldr$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"f316be52-1b05-4088-9f34-5c0d8dd0881d","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"_$System:Year.Number:toString$_$System:Month.Number:toString$_$System:Day.Number:toString$_$System:Hour.Number:toString$_$System:Minute.Number:toString$_$System:Second.Number:toString$.png"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorScreenshotFileName"}},{"uid":"437de6e6-e889-4566-8bfa-2917dcdc364a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorScreenshotFileName.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorScreenshotFileName"}},{"uid":"d679040d-54ce-4ca8-a56d-e3c4d8ff9319","commandName":"captureDesktop","packageName":"Screen","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varErrorScrnShotsFldr$/$varErrorScreenshotFileName$"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"2c602ccb-50d4-416a-ba0a-af72e1863ad0","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorScrnShotsFldr$\\$varErrorScreenshotFileName$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorScreenshotPath"}},{"uid":"12be46f3-5bce-4cb5-8c8c-065ca6edb69f","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorScreenshotPath.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorScreenshotPath"}},{"uid":"bf921154-c127-4431-be75-10255c826d36","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"0bdf5f87-a0ee-4edc-9ce0-e0ec20ab30a6","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varErrorScrnShotsFldr$/ScreenshotsInfo.csv"}},{"name":"logContent","value":{"type":"STRING","string":"\"Transaction GUID\",\"Prior Policy Number\",\"Screenshot File Name\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$varErrorScrnShotsFldr$/ScreenshotsInfo.csv"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"fileNotExists","packageName":"File"}}]},{"uid":"f126ecd6-59c7-4a64-b2c3-e6ea5b10a98d","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varErrorScrnShotsFldr$/ScreenshotsInfo.csv"}},{"name":"logContent","value":{"type":"STRING","expression":"\"$varTransactionguid$\",\"$varPriorPolicyNo$\",\"$varErrorScreenshotFileName$\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"af90060b-7de1-498a-905f-8120c293aa1b","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"3e4cc707-fd1b-42be-8890-934381790bbd","commandName":"assign","packageName":"Boolean","disabled":true,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}}}]}],"branches":[{"uid":"08f5ee8d-623e-493f-b120-2f733f004d87","commandName":"finally","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"f41cb389-eff3-4f14-99da-3b2749075ba5","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"288e9347-9276-4db5-9d81-0d5ab21488d8","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"message","value":{"type":"STRING","expression":"$Error-Description$ Exception occurred at line number $Error-LineNumber.Number:toString$. You chose to mark the bot as 'Failed' in case of any encountered errors."}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$M-IsBotExecutedSuccessfully.Boolean:toString$"}},{"name":"operator","value":{"type":"STRING","string":"EqualsTo"}},{"name":"value","value":{"type":"STRING","string":"false"}}],"value":{"type":"CONDITIONAL","conditionalName":"legacyConditionVariable","packageName":"LegacyAutomation"}}]}]}]}],"variables":[{"name":"varErrorScrnShotsFldr","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varErrorRemarks","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varLogFileAbsolutePath","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varErrorRemarks1","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varErrorScreenshotFileName","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varPriorPolicyNo","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varTransactionguid","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varErrorScreenshotPath","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"M-IsBotExecutedSuccessfully","description":"","type":"BOOLEAN","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":"true"}},{"name":"Error-Description","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-LineNumber","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.1.0-20210722-143718"},{"name":"Comment","version":"2.7.0-20210722-143743"},{"name":"ErrorHandler","version":"2.7.0-20210722-143834"},{"name":"File","version":"5.0.0-20210727-180900"},{"name":"Folder","version":"5.0.0-20210722-143841"},{"name":"If","version":"3.0.0-20210722-143856"},{"name":"LegacyAutomation","version":"4.4.0-20210803-013138"},{"name":"LogToFile","version":"3.1.0-20210722-144333"},{"name":"Number","version":"3.1.1-20210821-042642"},{"name":"Screen","version":"2.2.0-20210722-144743"},{"name":"String","version":"4.3.0-20210722-144812"},{"name":"System","version":"3.4.0-20210728-133940"}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"1","improvedNumberSupport":true,"timeout":"0s","automationPriority":"PRIORITY_LOW"}}