{"triggers":[],"nodes":[{"uid":"26abe52a-d06f-4d85-b1d1-d3efbe655110","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"d24646ae-64a0-41a8-9f2a-31fecb9e4ed1","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"17888c13-0797-402f-85b6-2f77918a4c8c","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"_________________ 1. SCRIPT NAME __________________"}}]},{"uid":"fb41e455-14ca-47b0-89bf-2628a4010220","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Horison Unlock.Report Logging Bot"}}]},{"uid":"a7a2b7df-abec-4456-8808-233b770da33d","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"_________________ 2. PURPOSE __________________"}}]},{"uid":"132c6042-a5a1-4546-8bf3-3c8ab9683a0c","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"To log the processed Horison Unlock ticket details in Report CSV File"}}]},{"uid":"a826ed54-15b3-43e6-8d00-7d51e066f42a","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"_________________ 3. IMPLEMENTATION __________________"}}]},{"uid":"e06b32f7-2745-4264-8ce7-aa68a45c5301","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Log the ticket details in Report CSV File"}}]},{"uid":"c1e0c667-542e-4fba-a973-66b8a97b3c2c","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"In case of failure while Loading the file/entering to a field, ERROR flag will be raised and BOT may be stopped"}}]},{"uid":"dad350a0-065c-4b38-9e98-d4264cf3a486","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"#########################################################################################"}}]},{"uid":"59917fb4-9c22-4ee7-849e-767194b3aa91","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"#########################################################################################"}}]},{"uid":"94d71e02-280b-4278-ade4-8801ab6f0f86","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Horison Unlock.Report Logging Bot"}}],"returnTo":{"type":"VARIABLE","variableName":"BOTNAME"}},{"uid":"d4970eaf-5940-4dce-ba70-e78ede00e92b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$BOTNAME.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"BOTNAME"}},{"uid":"4480dac0-ac7b-404c-924f-6764c3f1b968","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"uid":"d61023bf-0350-4f0a-ae19-18fcb70859e1","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorRemarks.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"uid":"a059c427-6e9d-42fb-a777-fe7f8978b50c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"False"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"uid":"0042913f-4e42-45d2-89a1-5aaca925b912","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorStatus.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"uid":"b723f54a-188f-43dc-8f39-cf879cfd9976","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",INFO,$BOTNAME$,START"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"b6893bd3-faaa-4ea7-a96a-9864e730a3fe","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------Checking Whether Report CSV File exists or Not"}}]},{"uid":"ae7da6f5-b1f6-49a8-931b-2590e0e95bea","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"9df0d25d-4c74-4733-a202-9d9f799af86d","commandName":"createFile","packageName":"File","disabled":true,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varCsv$/Report.csv"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"0834a190-970e-40d8-8577-b16eca0a4e4d","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",INFO,$BOTNAME$,Report CSV file Created"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"bf5ed691-778d-464a-8263-e76bfe57b22d","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------Set Column Names as Policy#,Bot Name,Status,Remarks,Start Time,End Time in Report CSV File"}}]},{"uid":"7bea68f1-2d3c-4ea5-8df0-f7e28034dca5","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varCsv$/Horison%20Unlock%20Report_$varBOTRunDate$.csv"}},{"name":"logContent","value":{"type":"STRING","string":"Policy#,UserId#,Bot Name,Status,Remarks,Start Time,End Time"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$varCsv$/Horison%20Unlock%20Report_$varBOTRunDate$.csv"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"fileNotExists","packageName":"File"}}]},{"uid":"cd9458a5-da21-44d1-aed6-b9a82004f8e8","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$@AADefaultDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"1e6761ca-ed69-4438-b8e0-0e436fefec0e","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$m-date-string$"}}],"returnTo":{"type":"VARIABLE","variableName":"varEndTime"}},{"uid":"0c69d662-1b95-40d2-8264-91ddc9f739d6","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------Setting Policy#,Bot Name,Status,Remarks values in Report CSV File"}}]},{"uid":"b32905cb-824b-4037-b632-076e0f1cb880","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varCsv$/Horison%20Unlock%20Report_$varBOTRunDate$.csv"}},{"name":"logContent","value":{"type":"STRING","expression":"$varPolicyno$,$varUserID$,$varSQLBotName$,$varStatus$,$varRemarks$,$varStartTime$,$varEndTime$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"0ed59609-6359-439f-a1f4-d9c2fbd743a2","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"554652dc-a74e-4242-bef1-5e7f9e9c0710","commandName":"assign","packageName":"Boolean","disabled":true,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}},{"uid":"944ec6e2-5670-434d-835c-5fd493925fb2","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",ERROR,$BOTNAME$,$Error-LineNumber.Number:toString$,$Error-Description$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"ab572332-fcfb-4d2b-9c29-eea3f0d73664","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"True"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"uid":"d947c32d-18bf-44c4-9062-4cc67cfc1504","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorStatus.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorStatus"}}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}}}]},{"uid":"e08aeb20-8fa2-46f5-ad7b-c6440cd8f32d","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"584460c2-0135-4b66-9cbb-92ded61fa997","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"------- This second error handling is necessary only here, if suppose the log file creation is unsuccessful in the logic"}}]},{"uid":"a3ad9422-6e32-4d26-8860-c5ca733769de","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"c991cef2-b29c-4ea0-9b1d-8dcadb613afd","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",INFO,$BOTNAME$,END,"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"adb9447f-5cdf-4ffd-a9a8-0a8fa3951c80","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"82dfc64f-d2c2-428f-bbb3-a30b36833d7b","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------ON Error"}}]},{"uid":"19d7227d-9fab-4302-b180-6f2ef995b21e","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"0764fe99-62a0-485e-a2ee-9b2aea7aae56","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"Unexpected exception at $BOTNAME$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"uid":"7464f163-25f6-4d38-a15c-716e64f7d425","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorRemarks.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"uid":"e5a703d1-899c-4cc8-99d6-17309edf88b0","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",ERROR,$BOTNAME$,Unexpected exception at $BOTNAME$,$Error-LineNumber.Number:toString$,$Error-Description$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"763490be-9e64-407b-8220-14861cf94177","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",INFO,$BOTNAME$,END,"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"eac8709b-6aaf-42c8-94c3-2f9a8084db3a","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"84d00caa-0c97-439c-8d93-d23858882843","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",INFO,$BOTNAME$,END,"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$varErrorRemarks$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"d598d925-4256-45d9-8571-6abd792d25f0","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------ON Error"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$varErrorStatus$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"False"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"branches":[{"uid":"f8c13371-393e-47a2-9734-e711ca43edcc","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"b4071ff6-6da7-49a1-9a82-a20d9b5fabb1","commandName":"assign","packageName":"Boolean","disabled":true,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}}}]}],"branches":[{"uid":"6f6f96f2-64b8-4173-b404-33a77ba1c96d","commandName":"finally","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"39c33ded-6f14-484b-a076-9e3ef2eea700","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"1903886f-befb-4b90-94c3-ade007d0ef17","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"message","value":{"type":"STRING","string":"You chose to mark the bot as 'Failed' in case of any encountered errors."}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$M-IsBotExecutedSuccessfully.Boolean:toString$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"false"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}]}]}],"variables":[{"name":"BOTNAME","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varErrorRemarks","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varErrorStatus","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varCsv","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varReportCsvFlExst","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varPolicyno","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varStatus","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varRemarks","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varCSVRowCounter","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varEndTime","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varLogFilePath","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varSQLBotName","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varStartTime","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varUserID","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varBOTRunDate","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"M-IsBotExecutedSuccessfully","description":"","type":"BOOLEAN","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":"true"}},{"name":"Error-Description","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-LineNumber","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-return-date","description":"","type":"DATETIME","subtype":"UNDEFINED","input":false,"output":false},{"name":"m-date-string","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"window-1-1-1-1-1","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"Report*","path":"","class":"","handle":"0","isChild":false,"location":{"top":0,"left":0},"size":{"height":0,"width":0}}}}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.1.0-20201126-165109"},{"name":"Comment","version":"2.3.0-20201126-165125"},{"name":"Datetime","version":"2.2.0-20201126-165136"},{"name":"ErrorHandler","version":"2.3.0-20201126-165148"},{"name":"File","version":"3.2.0-20201126-165151"},{"name":"If","version":"2.1.0-20201126-165201"},{"name":"LegacyAutomation","version":"3.2.0-20201124-064544"},{"name":"LogToFile","version":"2.2.0-20201126-165428"},{"name":"Number","version":"2.1.0-20201126-165444"},{"name":"String","version":"3.1.0-20201126-165909"},{"name":"System","version":"3.0.0-20200921-090225"}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"1","improvedNumberSupport":false,"timeout":"0s","automationPriority":"PRIORITY_MEDIUM"}}