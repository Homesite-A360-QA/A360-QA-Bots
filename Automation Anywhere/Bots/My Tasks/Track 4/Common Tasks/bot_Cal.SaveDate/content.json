{"triggers":[],"nodes":[{"uid":"9bc633be-d4fb-4828-bd71-9c6df779542b","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"164763e7-3746-41cd-b315-acbef99d625e","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"3dbb5c15-5272-43fc-baab-c5757156eec0","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"#########################################################################################"}}]},{"uid":"c408fc21-b757-4548-95be-8abddcce9e4b","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"_________________ 1. SCRIPT NAME __________________"}}]},{"uid":"93809699-df0b-4ea7-ae5c-e15525bf31c4","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Calculate Save Date BOT"}}]},{"uid":"4011244b-1da1-4e12-8217-25206a1140aa","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"_________________ 2. PURPOSE __________________"}}]},{"uid":"322cb262-a5c0-46df-a70a-0fdc717cc6b5","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"To Get the Valid Save Date For Horison"}}]},{"uid":"84fcdfad-1ddc-46bf-a8d6-e25ea28eaf84","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"_________________ 3. IMPLEMENTATION __________________"}}]},{"uid":"1bf6eb02-d321-41b6-8330-2a3ecdd738c0","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"If Given effective date is valid then same date will be returned if not the policy start date will be returned"}}]},{"uid":"a87dfbb4-0805-4d39-b45a-1c675ce83253","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":" "}}]},{"uid":"aff7dd1c-c8b6-4913-bdb8-78ec7fe10e5e","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"################### LOGIC  ###################"}}]},{"uid":"89171e65-ba01-4b49-96a1-22d21b1a91eb","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"uid":"b0f59146-4e4b-4f6a-a8af-8d1f06bb3a80","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorRemarks.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"uid":"6622e228-681d-42f1-8752-967ed0fb7767","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"False"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"uid":"d909c407-52ab-452a-b168-d64bcef5194c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorStatus.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"uid":"42e03f2c-c89d-47cd-8ada-4b576834e46c","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"#########################################################################################"}}]},{"uid":"a38974e9-b2ae-4876-83ea-8518120b7b41","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",\"INFO\",\"$BOTNAME$\",\"START\",\"\",\"\",\"\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"1711c4c0-ec0e-49a7-af79-bbf4ce231750","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Tasks/Track%204/Common%20Tasks/Horison%20Format%20Date"},"taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"varDate","value":{"type":"STRING","expression":"$varDate$"}},{"key":"varDateFormat","value":{"type":"STRING","expression":"$varDateFormat$"}},{"key":"varErrorRemarks","value":{"type":"STRING","expression":"$varErrorRemarks$"}},{"key":"varErrorStatus","value":{"type":"STRING","expression":"$varErrorStatus$"}},{"key":"varLogFilePath","value":{"type":"STRING","expression":"$varLogFilePath$"}}]},"taskbotOutput":{"type":"DICTIONARY","dictionary":[]}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"varDate","value":{"type":"VARIABLE","variableName":"varDate"}},{"key":"varDateFormat","value":{"type":"VARIABLE","variableName":"varDateFormat"}},{"key":"varErrorRemarks","value":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"key":"varErrorStatus","value":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"key":"varLogFilePath","value":{"type":"VARIABLE","variableName":"varLogFilePath"}}]}},{"uid":"90709952-572b-4cd7-994a-b2e3d9e7be27","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"ca26846a-5e9a-4d47-8f96-7930b20d853e","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$varErrorStatus$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"True"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"9865b646-6737-4fc1-bdf0-0136bfc6a572","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Tasks/Track%204/Common%20Tasks/Validation%20For%20Effective%20Date"},"taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"varDate","value":{"type":"STRING","expression":"$varDate$"}},{"key":"varErrorRemarks","value":{"type":"STRING","expression":"$varErrorRemarks$"}},{"key":"varErrorStatus","value":{"type":"STRING","expression":"$varErrorStatus$"}},{"key":"varLogFilePath","value":{"type":"STRING","expression":"$varLogFilePath$"}}]},"taskbotOutput":{"type":"DICTIONARY","dictionary":[]}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"varDate","value":{"type":"VARIABLE","variableName":"varDate"}},{"key":"varErrorRemarks","value":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"key":"varErrorStatus","value":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"key":"varLogFilePath","value":{"type":"VARIABLE","variableName":"varLogFilePath"}}]}},{"uid":"9c8a1741-cd4f-4acd-b16b-affc66ddd792","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"a2aa0d76-0917-4367-b30d-574da85b3bdd","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$varErrorStatus$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"True"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"6dd4c8cb-17c5-4942-ae1e-678808aab4bf","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$varDate$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]}],"branches":[{"uid":"14ea7d92-6c2b-48cb-b800-5e5c7a663577","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"4b3e032d-ff47-4ff5-8e00-39e886fc60e4","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}},{"uid":"4345a543-2793-477c-88e5-f1e1c6b2b398","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",ERROR,$BOTNAME$,$Error-Description$,$Error-LineNumber.Number:toString$,\n,INFO,$BOTNAME$,END\n"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"5dc9543e-1580-4566-9ee2-8ea10d3f9f7b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"True"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"uid":"bc473036-0097-4db7-9c42-479d35da856b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorStatus.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorStatus"}}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}}}]},{"uid":"93195802-9666-4c5b-aff8-a3e5dfd4101c","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"13298dd6-622e-4a6f-9fb6-afef00c2adf3","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"------- This second error handling is necessary only here, if suppose the log file creation is unsuccessful in the logic"}}]},{"uid":"e7a26d5c-ae94-436f-a88f-d195c64ba63b","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"6f5fecfe-daf3-4907-95fc-8f638ee3c2ac","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",INFO,$BOTNAME$,END,"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"d8662788-ec5a-4dce-a782-4ebda005a69a","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"7007865d-23bb-4073-a73c-2ff7a2d75dc3","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------ON Error"}}]},{"uid":"e567dafd-cf17-4f4e-b414-7888c01617d4","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"d7e8acfd-a3e1-42d5-964c-12aa406a6290","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"Unexpected exception at $BOTNAME$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"uid":"49b98146-caec-4364-b9f8-c3cafb81c35c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorRemarks.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"uid":"3517f868-e747-45ea-980e-eb01caba2599","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",ERROR,$BOTNAME$,Unexpected exception at $BOTNAME$,$Error-LineNumber.Number:toString$,$Error-Description$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"acdbee50-f0fb-45b5-8ad7-148eae601441","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",INFO,$BOTNAME$,END,"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"3e9c3e7a-c748-4484-9099-eb5dbcfede2c","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"1c27c143-794f-45d8-8deb-a3174cb4a2e8","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",INFO,$BOTNAME$,END,"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$varErrorRemarks$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"8ba3a6dc-842f-4ffc-a3ca-61a196bf41d2","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------ON Error"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$varErrorStatus$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"False"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"branches":[{"uid":"7e2276a2-dd3c-479d-892f-0bc0c4608fc0","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"67dbf4d9-e739-43dc-89a0-78a0acf25348","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}}}]}],"branches":[{"uid":"c6e9fcb8-2dd8-46eb-aefc-61ca73f48ee9","commandName":"finally","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"4bad83e5-6173-42ea-8d67-d8350cc59b3f","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"04e4dfc6-4e55-4618-a0fc-ec3c8817ad18","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",ERROR,$BOTNAME$,$Error-Description$,$Error-LineNumber.Number:toString$,\n,INFO,$BOTNAME$,END\n"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"4de0065f-33e0-4cf0-8f61-d3754d561797","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"message","value":{"type":"STRING","string":"You chose to mark the bot as 'Failed' in case of any encountered errors."}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$M-IsBotExecutedSuccessfully.Boolean:toString$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"false"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}]}]}],"variables":[{"name":"varErrorStatus","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varErrorRemarks","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varLogFilePath","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"C:\\Users\\mt_rmi\\Documents\\Automation Anywhere Files\\Automation Anywhere\\My Docs\\Protective Device\\Input Folder\\log.csv"}},{"name":"BOTNAME","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"Calculate Save Date"}},{"name":"varDateFormat","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"YYYYDDMM"}},{"name":"varDate","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"20212104"}},{"name":"M-IsBotExecutedSuccessfully","description":"","type":"BOOLEAN","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":"true"}},{"name":"Error-Description","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-LineNumber","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.1.0-20201126-165109"},{"name":"Comment","version":"2.3.0-20201126-165125"},{"name":"ErrorHandler","version":"2.3.0-20201126-165148"},{"name":"If","version":"2.1.0-20201126-165201"},{"name":"LegacyAutomation","version":"3.2.0-20201124-064544"},{"name":"LogToFile","version":"2.2.0-20201126-165428"},{"name":"MessageBox","version":"2.1.0-20201126-165430"},{"name":"Number","version":"2.1.0-20201126-165444"},{"name":"String","version":"3.1.0-20201126-165909"},{"name":"TaskBot","version":"2.0.1-20201208-065519"}],"workItemTemplateName":null}