{"triggers":[],"nodes":[{"uid":"6a6cf762-329a-4d1e-8613-66c8775dc634","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"f4b3d5c0-ef25-4b2d-bfd3-25e89e48494f","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"e14bb564-75f5-4786-8fba-2cb9bdb50426","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"#########################################################################################"}}]},{"uid":"3fa7db5d-74c4-47a9-840d-85bf3343abf5","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"_________________ 1. SCRIPT NAME __________________"}}]},{"uid":"3d5ced44-547f-47a9-99a3-f798a43e437b","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Cal.Save Date BOT"}}]},{"uid":"77158886-5cf4-471f-ba27-0b32b8c6e937","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"_________________ 2. PURPOSE __________________"}}]},{"uid":"7ca86079-3827-4e82-8e05-82552db17f83","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"To Get the Valid Save Date For Horison"}}]},{"uid":"1e553207-fe8b-4f0b-abf1-f59abf90b1c2","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"_________________ 3. IMPLEMENTATION __________________"}}]},{"uid":"920e6c50-3890-4919-84fb-0101c9b6515f","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"If Given effective date is valid then same date will be returned if not the policy start date will be returned"}}]},{"uid":"1819cd07-4842-44da-a4ca-f4f5e3f98cc9","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":" "}}]},{"uid":"b2548d44-ebc7-4af5-aed2-cabd6336f07c","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"################### LOGIC  ###################"}}]},{"uid":"5aea7f81-fd51-434d-a795-40915c050689","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"uid":"30d2658a-a014-4af3-ba3e-3852e1949566","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorRemarks.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"uid":"44793bfb-f017-4cbb-8609-ef8c4884b746","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"False"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"uid":"64f81a0c-b3f0-44f1-8e5a-672e21cfe214","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorStatus.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"uid":"8cdb8f0c-076f-4b82-9d79-1eb06bb00790","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"#########################################################################################"}}]},{"uid":"0e53c6c6-644e-4075-8d06-ba934a9f49a8","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",\"INFO\",\"$BOTNAME$\",\"START\",\"\",\"\",\"\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"8bfe5673-9074-481b-9a72-e3cebe160edd","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Tasks/Track%204/Common%20Tasks/Horison%20Format%20Date"},"taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"varDate","value":{"type":"STRING","expression":"$varDate$"}},{"key":"varDateFormat","value":{"type":"STRING","expression":"$varDateFormat$"}},{"key":"varErrorRemarks","value":{"type":"STRING","expression":"$varErrorRemarks$"}},{"key":"varErrorStatus","value":{"type":"STRING","expression":"$varErrorStatus$"}},{"key":"varLogFilePath","value":{"type":"STRING","expression":"$varLogFilePath$"}}]},"taskbotOutput":{"type":"DICTIONARY","dictionary":[]}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"varDate","value":{"type":"VARIABLE","variableName":"varDate"}},{"key":"varDateFormat","value":{"type":"VARIABLE","variableName":"varDateFormat"}},{"key":"varErrorRemarks","value":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"key":"varErrorStatus","value":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"key":"varLogFilePath","value":{"type":"VARIABLE","variableName":"varLogFilePath"}}]}},{"uid":"f8c3da14-0fae-4c7e-b705-6cdadd668159","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"e4986ea6-3fdf-49ca-8a9f-45c5edf5c48a","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$varErrorStatus$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"True"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"8f4d8f4b-a632-4550-a288-60ab1debbd8a","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Tasks/Track%204/Common%20Tasks/Validation%20For%20Effective%20Date"},"taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"varDate","value":{"type":"STRING","expression":"$varDate$"}},{"key":"varErrorRemarks","value":{"type":"STRING","expression":"$varErrorRemarks$"}},{"key":"varErrorStatus","value":{"type":"STRING","expression":"$varErrorStatus$"}},{"key":"varLogFilePath","value":{"type":"STRING","expression":"$varLogFilePath$"}}]},"taskbotOutput":{"type":"DICTIONARY","dictionary":[]}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"varDate","value":{"type":"VARIABLE","variableName":"varDate"}},{"key":"varErrorRemarks","value":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"key":"varErrorStatus","value":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"key":"varLogFilePath","value":{"type":"VARIABLE","variableName":"varLogFilePath"}}]}},{"uid":"a1d4e38e-6369-4b64-97b5-e2d4d3f10ecf","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"226a82d4-25c6-477a-be5d-77b089d5d84b","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$varErrorStatus$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"True"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"4e6df192-cac4-4458-a47e-db2cd2a52a9d","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$varDate$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]}],"branches":[{"uid":"17399fcd-779a-4868-b110-fd4ef4c3c949","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"3fada405-2be1-428f-8a8c-fc66d9462818","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}},{"uid":"b2b9c4da-38eb-418b-99cb-c3fcc0d3f11b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"True"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"uid":"de91dc3e-f293-4337-8df3-bfca6fc1a225","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorStatus.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorStatus"}}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}}}]},{"uid":"b55080fc-3944-4972-937e-195257417e28","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"94ec62da-fa9f-4bf7-9fab-fdd5cc9070c7","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"------- This second error handling is necessary only here, if suppose the log file creation is unsuccessful in the logic"}}]},{"uid":"2b7ea6fe-eb7c-4c4a-bc21-40ffb39e16bc","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"8db5d05e-0e3d-45e5-acfa-e19dacbb579b","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",INFO,$BOTNAME$,END,"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"722c47cf-8514-45e4-aed3-6db11736b262","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"c70d71e8-38e9-4da2-96be-41308a5a34aa","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------ON Error"}}]},{"uid":"c84fdd15-8b2b-49ea-87c4-26e5599f2eea","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"92b92d55-4552-45e8-a428-09681a851fe7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"Unexpected exception at $BOTNAME$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"uid":"99625398-0d1d-4589-9f24-669bea65eef6","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorRemarks.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"uid":"e87154a6-1b78-47be-903a-5b4eba83d12a","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",ERROR,$BOTNAME$,Unexpected exception at $BOTNAME$,$Error-LineNumber.Number:toString$,$Error-Description$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"323cdb75-c79e-40a1-97f1-c81329e5418a","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",INFO,$BOTNAME$,END,"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"73184726-3263-4b78-96f2-2837f3704eef","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"49fe9897-dfce-450e-923b-95a9692dd45e","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",INFO,$BOTNAME$,END,"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$varErrorRemarks$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"1a9a14ab-0184-4dda-9b0e-429705ae05c5","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------ON Error"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$varErrorStatus$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"False"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"branches":[{"uid":"12992a1b-82f6-4790-ad88-232ad4b5185d","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"4565577a-8436-4d45-bdec-b99232aca335","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}}}]}],"branches":[{"uid":"e187cdfa-d085-4796-9608-f5fdcb7d1afb","commandName":"finally","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"56da068a-68b9-445a-b1ad-3e86dcf76c80","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"c38a94ae-8043-4010-be31-93a6c1fad1c5","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"message","value":{"type":"STRING","string":"You chose to mark the bot as 'Failed' in case of any encountered errors."}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$M-IsBotExecutedSuccessfully.Boolean:toString$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"false"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}]}]}],"variables":[{"name":"varErrorStatus","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varErrorRemarks","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varLogFilePath","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"C:\\Users\\mt_rmi\\Documents\\Automation Anywhere Files\\Automation Anywhere\\My Docs\\Protective Device\\Input Folder\\log.csv"}},{"name":"varDateFormat","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"YYYYDDMM"}},{"name":"varDate","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"20212104"}},{"name":"BOTNAME","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"Cal Save Date"}},{"name":"M-IsBotExecutedSuccessfully","description":"","type":"BOOLEAN","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":"true"}},{"name":"Error-Description","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-LineNumber","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.1.0-20210722-143718"},{"name":"Comment","version":"2.7.0-20210722-143743"},{"name":"ErrorHandler","version":"2.7.0-20210722-143834"},{"name":"If","version":"3.0.0-20210722-143856"},{"name":"LegacyAutomation","version":"4.4.0-20210803-013138"},{"name":"LogToFile","version":"3.1.0-20210722-144333"},{"name":"MessageBox","version":"3.0.0-20210722-144335"},{"name":"Number","version":"3.1.1-20210821-042642"},{"name":"String","version":"4.3.0-20210722-144812"},{"name":"TaskBot","version":"2.1.0-20210716-100552"}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"1","improvedNumberSupport":false,"timeout":"0s","automationPriority":"PRIORITY_MEDIUM"}}