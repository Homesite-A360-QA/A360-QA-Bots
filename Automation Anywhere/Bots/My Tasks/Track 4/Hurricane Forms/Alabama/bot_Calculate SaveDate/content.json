{"triggers":[],"nodes":[{"uid":"0e183caf-9d55-478d-9347-1ff55d859730","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"a893c0da-d2e3-46f7-a469-0c84d8ac21dc","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"f5e746b7-d95d-44bb-a05c-b7733c09ede4","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"#########################################################################################"}}]},{"uid":"729470a4-96d5-41e1-8973-f79b81c5e91e","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"_________________ 1. SCRIPT NAME __________________"}}]},{"uid":"408ab102-8a60-4475-81cb-76e27341d245","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Calculate Save Date BOT"}}]},{"uid":"cfacb96e-36d4-4270-907b-22882d6473e2","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"_________________ 2. PURPOSE __________________"}}]},{"uid":"7b6ed03b-a7c0-454e-a027-81a0ca074dfa","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"To Get the Valid Save Date For Horison"}}]},{"uid":"0472d246-5746-4c0c-a53b-0c12c33b231b","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"_________________ 3. IMPLEMENTATION __________________"}}]},{"uid":"7e402288-eb37-46ae-b79b-a1cf8e663d3a","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"If Given effective date is valid then same date will be returned if not the policy start date will be returned"}}]},{"uid":"cf51686e-7e03-479e-9f0d-c96037638049","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":" "}}]},{"uid":"2f723090-e5d2-45f4-9fa8-5b4c9f6fdd27","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"################### LOGIC  ###################"}}]},{"uid":"f637e95a-7755-4108-8489-a6d64c554838","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"uid":"5c68050a-a692-4efb-8c5c-0e7a09a73422","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorRemarks.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"uid":"e4585b0a-daa6-4b1b-a6ac-745712b0e472","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"False"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"uid":"ae310f34-2bdc-4738-8afd-b9eaf7e41350","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorStatus.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"uid":"d5c70632-d29a-44a5-9043-18aa22b977c9","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"#########################################################################################"}}]},{"uid":"30e88bd1-124e-476c-aed6-d4eb72c6c5d5","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",\"INFO\",\"$BOTNAME$\",\"START\",\"\",\"\",\"\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"f921dca1-8a73-4a61-a16c-753867efbb65","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Tasks/Track%204/Common%20Tasks/Horison%20Format%20Date"},"taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"varDate","value":{"type":"STRING","expression":"$varDate$"}},{"key":"varDateFormat","value":{"type":"STRING","expression":"$varDateFormat$"}},{"key":"varErrorRemarks","value":{"type":"STRING","expression":"$varErrorRemarks$"}},{"key":"varErrorStatus","value":{"type":"STRING","expression":"$varErrorStatus$"}},{"key":"varLogFilePath","value":{"type":"STRING","expression":"$varLogFilePath$"}}]},"taskbotOutput":{"type":"DICTIONARY","dictionary":[]}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"varDate","value":{"type":"VARIABLE","variableName":"varDate"}},{"key":"varDateFormat","value":{"type":"VARIABLE","variableName":"varDateFormat"}},{"key":"varErrorRemarks","value":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"key":"varErrorStatus","value":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"key":"varLogFilePath","value":{"type":"VARIABLE","variableName":"varLogFilePath"}}]}},{"uid":"fe0d1e8a-c782-4667-afb1-51e904d2b64f","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"e7ba04ca-8fb5-46ba-bed3-9c16a3ccc2db","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$varErrorStatus$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"True"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"8d6112f0-e40c-4962-8539-f9861b8f6893","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Tasks/Track%204/Common%20Tasks/Validation%20For%20Effective%20Date"},"taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"varDate","value":{"type":"STRING","expression":"$varDate$"}},{"key":"varErrorRemarks","value":{"type":"STRING","expression":"$varErrorRemarks$"}},{"key":"varErrorStatus","value":{"type":"STRING","expression":"$varErrorStatus$"}},{"key":"varLogFilePath","value":{"type":"STRING","expression":"$varLogFilePath$"}}]},"taskbotOutput":{"type":"DICTIONARY","dictionary":[]}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"varDate","value":{"type":"VARIABLE","variableName":"varDate"}},{"key":"varErrorRemarks","value":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"key":"varErrorStatus","value":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"key":"varLogFilePath","value":{"type":"VARIABLE","variableName":"varLogFilePath"}}]}},{"uid":"5efc94de-5c9d-43ec-adc4-1532dcb6588f","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"d4ef1b9c-90ce-44df-b9f4-e2fa1224283a","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$varErrorStatus$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"True"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"724d4367-cf17-45af-bc7e-896eadcec787","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$varDate$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]}],"branches":[{"uid":"1aa7bbdb-2978-4dd9-9a62-d82609c0b4b9","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"50b20961-c1d8-479c-923d-d199dd6107d1","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}},{"uid":"1c028061-dd45-46f7-b9de-00ccd1e3c268","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"True"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"uid":"6667fcf2-6f26-44cc-b341-1f4db9ff7be4","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorStatus.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorStatus"}}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}}}]},{"uid":"7a418813-f8db-422f-ba6e-520d81da7d7b","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"41cd0ad0-2585-45db-9902-acca0c2498af","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"------- This second error handling is necessary only here, if suppose the log file creation is unsuccessful in the logic"}}]},{"uid":"1b051228-1cd3-47c6-920c-ce1c4cee690d","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"cf831ce5-d8de-4bfb-b24a-c63f356f61a1","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",INFO,$BOTNAME$,END,"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"94ab04c2-e7d5-47dd-98e0-38d547cc491a","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"792a75d8-3972-432b-b3c5-3689de5f2f44","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------ON Error"}}]},{"uid":"ae693e67-aaf2-4cf2-bdff-f1e90ceada8d","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"628ff344-210d-4e12-b89a-c8f2183e8940","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"Unexpected exception at $BOTNAME$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"uid":"15136fab-d67f-4e3f-be75-50dc0b115b3a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorRemarks.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"uid":"c2b0fa33-f1a7-4ae4-8186-d252d55204cc","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",ERROR,$BOTNAME$,Unexpected exception at $BOTNAME$,$Error-LineNumber.Number:toString$,$Error-Description$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"1d4b1702-9abb-4904-8158-6c25f6f56536","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",INFO,$BOTNAME$,END,"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"81290755-4674-4539-b87f-8f2212cad53a","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"aa7d97d4-e58b-460e-8156-4f312214d5aa","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",INFO,$BOTNAME$,END,"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$varErrorRemarks$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"bc178f15-f00c-4f1d-882f-0236277113e5","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------ON Error"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$varErrorStatus$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"False"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"branches":[{"uid":"b23e1664-a42e-4b68-b874-76b3b01e5585","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"79afff3a-8367-49f3-aa99-8c1517caec99","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}}}]}],"branches":[{"uid":"00c3e18d-f482-42f9-8bfe-e7b5f00f504d","commandName":"finally","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"7c712d97-7809-49ba-b106-8e50b6321849","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"1c6e8757-b0ad-4381-9c2b-441943bf68e3","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"message","value":{"type":"STRING","string":"You chose to mark the bot as 'Failed' in case of any encountered errors."}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$M-IsBotExecutedSuccessfully.Boolean:toString$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"false"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}]}]}],"variables":[{"name":"varErrorStatus","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varErrorRemarks","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varLogFilePath","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"C:\\Users\\mt_rmi\\Documents\\Automation Anywhere Files\\Automation Anywhere\\My Docs\\Protective Device\\Input Folder\\log.csv"}},{"name":"BOTNAME","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"Calculate Save Date"}},{"name":"varDateFormat","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"YYYYDDMM"}},{"name":"varDate","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"20212104"}},{"name":"M-IsBotExecutedSuccessfully","description":"","type":"BOOLEAN","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":"true"}},{"name":"Error-Description","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-LineNumber","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.1.0-20210722-143718"},{"name":"Comment","version":"2.7.0-20210722-143743"},{"name":"ErrorHandler","version":"2.7.0-20210722-143834"},{"name":"If","version":"3.0.0-20210722-143856"},{"name":"LegacyAutomation","version":"4.4.0-20210803-013138"},{"name":"LogToFile","version":"3.1.0-20210722-144333"},{"name":"MessageBox","version":"3.0.0-20210722-144335"},{"name":"Number","version":"3.1.1-20210821-042642"},{"name":"String","version":"4.3.0-20210722-144812"},{"name":"TaskBot","version":"2.1.0-20210716-100552"}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"1","improvedNumberSupport":false,"timeout":"0s","automationPriority":"PRIORITY_MEDIUM"}}