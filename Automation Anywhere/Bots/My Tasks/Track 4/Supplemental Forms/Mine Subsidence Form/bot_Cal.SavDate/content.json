{"triggers":[],"nodes":[{"uid":"03d3d384-1170-4ff5-9b16-391653695e84","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"ca957169-bf93-48ae-939b-fbbc6b165073","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"95d5b3de-1f22-4d7e-a105-1ff953c07eb7","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"#########################################################################################"}}]},{"uid":"f6314683-796c-46b5-bc80-bc33fa02680e","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"_________________ 1. SCRIPT NAME __________________"}}]},{"uid":"a4991039-12b7-43e6-a3c3-332994a84758","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Calculate Save Date BOT"}}]},{"uid":"dda3fdad-9a08-469c-9414-b26a320c5383","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"_________________ 2. PURPOSE __________________"}}]},{"uid":"27fc75a9-2513-44fa-8336-ce9d90cb8570","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"To Get the Valid Save Date For Horison"}}]},{"uid":"9fb60188-e498-4c23-888c-f473c835559d","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"_________________ 3. IMPLEMENTATION __________________"}}]},{"uid":"d09614ed-af93-42ae-84e3-60b0853022db","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"If Given effective date is valid then same date will be returned if not the policy start date will be returned"}}]},{"uid":"cdf98b0c-cd19-4390-864f-7bdf84668d25","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":" "}}]},{"uid":"9c25c751-931e-4660-85d1-a8ee39026be6","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"################### LOGIC  ###################"}}]},{"uid":"52a9b8a0-edbb-4f6f-a493-7efa7b806747","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"uid":"9fa8edc0-c036-4fd1-a5e7-f3bd73419cb3","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorRemarks.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"uid":"e8e779da-f216-4abf-8ad4-0a8c23348289","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"False"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"uid":"f3bea0f8-ea66-48ca-8222-fd61742766f6","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorStatus.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"uid":"7f802622-01e6-4ee0-8b33-31ab893b3cf9","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"#########################################################################################"}}]},{"uid":"8c4df862-caf3-4501-a26c-3520eb3f3ff4","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",\"INFO\",\"$BOTNAME$\",\"START\",\"\",\"\",\"\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"48c93b2a-6a5a-4a90-b51d-f244b5fdfd2e","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Tasks/Track%204/Common%20Tasks/Horison%20Format%20Date"},"taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"varDate","value":{"type":"STRING","expression":"$varDate$"}},{"key":"varDateFormat","value":{"type":"STRING","expression":"$varDateFormat$"}},{"key":"varErrorRemarks","value":{"type":"STRING","expression":"$varErrorRemarks$"}},{"key":"varErrorStatus","value":{"type":"STRING","expression":"$varErrorStatus$"}},{"key":"varLogFilePath","value":{"type":"STRING","expression":"$varLogFilePath$"}}]},"taskbotOutput":{"type":"DICTIONARY","dictionary":[]}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"varDate","value":{"type":"VARIABLE","variableName":"varDate"}},{"key":"varDateFormat","value":{"type":"VARIABLE","variableName":"varDateFormat"}},{"key":"varErrorRemarks","value":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"key":"varErrorStatus","value":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"key":"varLogFilePath","value":{"type":"VARIABLE","variableName":"varLogFilePath"}}]}},{"uid":"33d870a5-dc85-4c23-98e1-39f316f08292","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"c09fecc8-92dc-44ec-b6bc-58336913a18c","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$varErrorStatus$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"True"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"9a88ac4e-6006-4551-9b7b-014232c96e6c","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/My%20Tasks/Track%204/Common%20Tasks/Validation%20For%20Effective%20Date"},"taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"varDate","value":{"type":"STRING","expression":"$varDate$"}},{"key":"varErrorRemarks","value":{"type":"STRING","expression":"$varErrorRemarks$"}},{"key":"varErrorStatus","value":{"type":"STRING","expression":"$varErrorStatus$"}},{"key":"varLogFilePath","value":{"type":"STRING","expression":"$varLogFilePath$"}}]},"taskbotOutput":{"type":"DICTIONARY","dictionary":[]}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":true}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"varDate","value":{"type":"VARIABLE","variableName":"varDate"}},{"key":"varErrorRemarks","value":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"key":"varErrorStatus","value":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"key":"varLogFilePath","value":{"type":"VARIABLE","variableName":"varLogFilePath"}}]}},{"uid":"7c010899-d8d1-47b7-960f-675880fca2e8","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"d538e06c-16ae-44f2-8a5f-70d524b035f6","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$varErrorStatus$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"True"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"e28cf558-fbad-43fc-b7c6-fee9d4e392b9","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$varDate$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}},{"name":"timeOut","value":{"type":"NUMBER","number":"5"}}]}],"branches":[{"uid":"8958d1e9-68a6-49ad-b6c3-3e5225fef4d9","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"6f05c6bd-535f-40e8-8d47-81a36340bb40","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}},{"uid":"914b3be6-8cf9-4971-b14b-1bc9d02585a7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"True"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorStatus"}},{"uid":"c359ce5e-09a2-45eb-9c1b-a6989ea216ab","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorStatus.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorStatus"}}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}}}]},{"uid":"04554167-9359-4f35-a82f-97ada62db738","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"539bc3dc-f173-4e89-9622-3c24540eec08","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"------- This second error handling is necessary only here, if suppose the log file creation is unsuccessful in the logic"}}]},{"uid":"9cbb6c71-d602-4a31-8c71-eeef23d9d95c","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"e0ea7a89-a6de-42fd-98a7-bdb99321a4cb","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",INFO,$BOTNAME$,END,"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"3260f4bf-8309-4b72-95b1-7a53b38d77ea","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"c8093da0-b5ab-4328-9bc3-8a53f5650eeb","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------ON Error"}}]},{"uid":"3bbcdee6-c54b-42b6-b11d-44934b9ad78d","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"906ac0cf-b0fa-4497-a121-d4c101cb1801","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Unexpected exception at Cal.SavDate"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"uid":"59864e00-4bf7-42d5-ab12-6763d915b097","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$varErrorRemarks.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"varErrorRemarks"}},{"uid":"597972fe-c5db-45dd-9963-b2db7c3c95bc","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",ERROR,$BOTNAME$,Unexpected exception at $BOTNAME$,$Error-LineNumber.Number:toString$,$Error-Description$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"dac18362-4f23-4852-a772-39ffab8d5452","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",INFO,$BOTNAME$,END,"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"f27a4d95-43ec-4d40-afbd-5ef7e10a60b8","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"7005d22c-bdb4-4b60-bf55-77c87165735d","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$varLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",INFO,$BOTNAME$,END,"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$varErrorRemarks$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"169a1580-3f6d-412a-983a-fa715cb69c5f","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"--------ON Error"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$varErrorStatus$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"False"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"branches":[{"uid":"be9ca6e4-88c1-44f1-9f36-a1623f0c15d7","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"ae1b4ca3-de88-4c37-b526-6f356c8e9267","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}}}]}],"branches":[{"uid":"b210bb67-cb81-4304-a1a2-97a3fa79b281","commandName":"finally","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"0be0bf1e-3763-4282-ab51-ec3ab0bb1551","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"684e2a14-cefb-4788-8db0-35a08e3134a0","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"message","value":{"type":"STRING","string":"You chose to mark the bot as 'Failed' in case of any encountered errors."}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$M-IsBotExecutedSuccessfully.Boolean:toString$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"false"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}]}]}],"variables":[{"name":"varErrorStatus","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varErrorRemarks","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"varLogFilePath","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"C:\\Users\\mt_rmi\\Documents\\Automation Anywhere Files\\Automation Anywhere\\My Docs\\Protective Device\\Input Folder\\log.csv"}},{"name":"BOTNAME","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"Calculate Save Date"}},{"name":"varDateFormat","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"YYYYDDMM"}},{"name":"varDate","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":"20212104"}},{"name":"M-IsBotExecutedSuccessfully","description":"","type":"BOOLEAN","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":"true"}},{"name":"Error-Description","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-LineNumber","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.1.0-20210722-143718"},{"name":"Comment","version":"2.7.0-20210722-143743"},{"name":"ErrorHandler","version":"2.7.0-20210722-143834"},{"name":"If","version":"3.0.0-20210722-143856"},{"name":"LegacyAutomation","version":"4.4.0-20210803-013138"},{"name":"LogToFile","version":"3.1.0-20210722-144333"},{"name":"MessageBox","version":"3.0.0-20210722-144335"},{"name":"Number","version":"3.1.1-20210821-042642"},{"name":"String","version":"4.3.0-20210722-144812"},{"name":"TaskBot","version":"2.1.0-20210716-100552"}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"1","improvedNumberSupport":false,"timeout":"0s","automationPriority":"PRIORITY_MEDIUM"}}