{"triggers":[],"nodes":[{"uid":"f034571a-5a5a-482d-99ed-4f259b49b6d3","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"85f841b4-cfba-4df1-987c-a1b1086c7aa8","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"///////////////////////////////////////////////////////////////////"}}]},{"uid":"f1c98bcc-ac1b-482d-a160-c16c7a63ce8d","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Process Name: Device Connectivity Report"}}]},{"uid":"fca50bb3-d396-4fbd-aad7-543d40c2f1d9","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Created by: Parthiban Subramaniyan"}}]},{"uid":"2d0d25d3-654e-448f-ad8c-20cc58dc4e18","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"For: Homesite"}}]},{"uid":"a46aba17-364e-418e-b0ce-cafb5e80ed11","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Start Date: 7th June, 2021"}}]},{"uid":"6f5290ce-9905-48c2-8e65-f8fcfe892688","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"///////////////////////////////////////////////////////////////////"}}]},{"uid":"df3786f4-b903-441f-b70b-e7addd44ab06","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"766632e9-d5ff-4b1a-8084-14ac68dc82bb","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"VB Script to get Username"}}]},{"uid":"94ba8e0a-0dbd-4444-9708-8a9c3fdde6bd","commandName":"vbscript.commands.openScript","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"scriptOption","value":{"type":"STRING","string":"SCRIPT"}},{"name":"script","value":{"type":"STRING","string":"Function UserName()\n  UserName = CreateObject(\"WScript.Network\").UserName\nEnd Function"}}]},{"uid":"9f456e02-0051-46b5-9aa9-3ed58b36c3c7","commandName":"vbscript.commands.executeFunction","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"functionName","value":{"type":"STRING","string":"UserName"}}],"returnTo":{"type":"VARIABLE","variableName":"strUsername"}},{"uid":"d9c2e9e7-fb1e-4b65-a867-204edf1d249b","commandName":"vbscript.commands.closeScript","packageName":"VBScript","disabled":false,"attributes":[{"name":"session","value":{"string":"Default","type":"STRING"}}]},{"uid":"9adf7b3c-2a99-4d18-9fa2-5d429e233003","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Start Date"}}]},{"uid":"1b0fab97-d0f6-45db-99b6-7e7e7afbb2a0","commandName":"assign","packageName":"Datetime","disabled":false,"attributes":[{"name":"option","value":{"type":"STRING","string":"variable"}},{"name":"dateTime","value":{"type":"DATETIME","expression":"$System:Date$"}}],"returnTo":{"type":"VARIABLE","variableName":"dateToday"}},{"uid":"3fb23573-a2d8-4c7f-aa1e-474f6bb5f141","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"dateToday"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"MM/dd/yyyy"}}],"returnTo":{"type":"VARIABLE","variableName":"strStartDate"}},{"uid":"bf864b51-30ec-4d08-a0ba-ea4f8e2028f0","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Start Time"}}]},{"uid":"d6b7a5bb-25fd-4c6b-9f66-f2306d96ace4","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"dateToday"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"hh:mm:ss"}}],"returnTo":{"type":"VARIABLE","variableName":"strStartTime"}},{"uid":"81598b44-8f24-4fd1-8ef4-adf03a24e89a","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Batch Code"}}]},{"uid":"2ab68fcc-fd4d-4bcc-bb08-c018c44586eb","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"dateToday"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"MMddyyyy_hhmmss"}}],"returnTo":{"type":"VARIABLE","variableName":"strBatchCode"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"System Username, Start date, time and Batch Code"}}]},{"uid":"e6ac4e82-247d-4e0c-802d-584276de4fbd","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"394b8424-bc85-4be8-96df-e079682fda63","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"C:\\Users\\$strUsername$\\OneDrive - homesite.com\\Documents\\Automation Anywhere Files\\Automation Anywhere\\My Docs\\CR Monitoring Bot\\Device Connectivity Report"}}],"returnTo":{"type":"VARIABLE","variableName":"strBotFolder"}},{"uid":"b1327946-46b7-4a40-b069-07319941546b","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Reading Device Connectivity Report Config FIle"}}]},{"uid":"0511136f-7786-4568-9ad0-6358d7609169","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"strBotFolder","value":{"type":"STRING","expression":"$strBotFolder$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/CR%20Monitoring%20Bot/Device%20Connectivity%20Report/Sub%20Bot%20-%20Read%20Config%20File"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"boolErrorFlag","value":{"type":"VARIABLE","variableName":"boolErrorFlag"}},{"key":"strFolderLog","value":{"type":"VARIABLE","variableName":"strFolderLog"}},{"key":"strErrorMessage","value":{"type":"VARIABLE","variableName":"strErrorMessage"}},{"key":"strFolderErrorLog","value":{"type":"VARIABLE","variableName":"strFolderErrorLog"}},{"key":"strFolderArchive","value":{"type":"VARIABLE","variableName":"strFolderArchive"}},{"key":"strEmailBot","value":{"type":"VARIABLE","variableName":"strEmailBot"}},{"key":"strEmailOPSTeam","value":{"type":"VARIABLE","variableName":"strEmailOPSTeam"}},{"key":"strEmailUser","value":{"type":"VARIABLE","variableName":"strEmailUser"}},{"key":"strStartEmailSubject","value":{"type":"VARIABLE","variableName":"strStartEmailSubject"}},{"key":"strStartEmailBody","value":{"type":"VARIABLE","variableName":"strStartEmailBody"}},{"key":"strCompletionEmailSubject","value":{"type":"VARIABLE","variableName":"strCompletionEmailSubject"}},{"key":"strHardStopEmailSubject","value":{"type":"VARIABLE","variableName":"strHardStopEmailSubject"}},{"key":"strHardStopEmailBody","value":{"type":"VARIABLE","variableName":"strHardStopEmailBody"}},{"key":"strFolderInput","value":{"type":"VARIABLE","variableName":"strFolderInput"}},{"key":"strURLControlRoom","value":{"type":"VARIABLE","variableName":"strURLControlRoom"}}]}},{"uid":"3d6d9615-8d1f-4832-8ff6-831d143270a9","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Bot Error"}}]},{"uid":"84a03bca-a101-4d0b-9bcd-2c9c7a4eba1b","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"d4da709e-a0da-40ce-8ea9-9d3dc608eb6b","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Adding Error Message in Email Body"}}]},{"uid":"2ed752a9-6af1-4348-b5e0-34beeda34e63","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strHardStopEmailBody$"}},{"name":"find","value":{"type":"STRING","string":"%BotError%"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$strErrorMessage$"}}],"returnTo":{"type":"VARIABLE","variableName":"strHardStopEmailBody"}},{"uid":"d3bd963f-4f5d-4c80-85af-1741bf186c54","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Adding Machine Name in Email Body"}}]},{"uid":"b3cae706-d5b3-475c-84f6-1ddbba9e6b77","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strHardStopEmailBody$"}},{"name":"find","value":{"type":"STRING","string":"%BOTMachine%"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$System:Machine$"}}],"returnTo":{"type":"VARIABLE","variableName":"strHardStopEmailBody"}},{"uid":"74201adb-4d69-4124-ab7f-6c316b06ccdb","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"e87ce67d-378a-4794-ae99-d415e4988e9f","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$strEmailUser$"}},{"name":"cc","value":{"type":"STRING","expression":"$strEmailOPSTeam$"}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","expression":"$strHardStopEmailSubject$"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"$strHardStopEmailBody$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$strEmailBot$"}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"Device Connectivity Report","lockerName":"CR Monitoring Locker","attributeName":"Bot Email Username"}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"Device Connectivity Report","lockerName":"CR Monitoring Locker","attributeName":"Bot Email Password"}}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$strEmailBot$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$strEmailOPSTeam$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$strEmailUser$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"type":"BOOLEAN","boolean":false}}],"operator":"AND"},"operator":"AND"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"5e6307f1-d5c6-452d-be39-6d8d2d66da16","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"BOOLEAN","expression":"$boolErrorFlag$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"booleanVariable","packageName":"Boolean"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Reading Device Connectivity Report Config FIle"}}]},{"uid":"0dd94250-2c5f-48d8-bff7-f9066ed098e3","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"df0fc243-e5a7-46c5-bf75-93a1dc0c146c","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Adding Start Date and Time in Email Subject"}}]},{"uid":"eb9425b0-eb7c-4e66-bd65-267a7a96f667","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strStartEmailSubject$"}},{"name":"find","value":{"type":"STRING","string":"%CurrDateTime%"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$strStartDate$, $strStartTime$"}}],"returnTo":{"type":"VARIABLE","variableName":"strStartEmailSubject"}},{"uid":"55c346ef-8e20-432b-9d3b-e7b37ee3b76e","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$strEmailUser$"}},{"name":"cc","value":{"type":"STRING","expression":"$strEmailOPSTeam$"}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","expression":"$strStartEmailSubject$"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"$strStartEmailBody$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$strEmailBot$"}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"Device Connectivity Report","lockerName":"CR Monitoring Locker","attributeName":"Bot Email Username"}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"Device Connectivity Report","lockerName":"CR Monitoring Locker","attributeName":"Bot Email Password"}}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Sending Bot Initiation Email"}}]},{"uid":"ed71624e-f8c2-41ed-a936-1c53d6c4e9a5","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"901ad622-a3de-4d3d-9f26-e2746c0f1d79","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Log Folder"}}]},{"uid":"f04e33e0-53bc-41ea-a02b-78a653addf4c","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"b9367ebe-5fbc-4294-abfc-4faf7ebef555","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$strFolderLog$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$strFolderLog$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"38101bbe-f4ed-434f-a7d1-afbc7b48cec7","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Log File"}}]},{"uid":"664b813d-b668-47f7-a2a1-b20ec06a9ee1","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strFolderLog$\\BotRunLog_$strBatchCode$.txt"}}],"returnTo":{"type":"VARIABLE","variableName":"strFileBotRunLog"}},{"uid":"2b900e1a-d223-4782-b72d-6a810207b21d","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strFileBotRunLog$"}},{"name":"logContent","value":{"type":"STRING","string":"Creation of necessary folders and files Begins"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"693ddb67-7679-4dfc-acd0-bf6bf7b23389","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Error Folder"}}]},{"uid":"bccb9f9e-05d2-4b4e-b106-ade616a3ae3c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strFolderErrorLog$\\$strBatchCode$"}}],"returnTo":{"type":"VARIABLE","variableName":"strFolderErrorLog"}},{"uid":"62ad6648-abb2-4a45-92cb-8e4edfa0d7ae","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"d8e6f881-956a-4fd0-b719-8a56b0431e83","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$strFolderErrorLog$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$strFolderErrorLog$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"c7e9ab66-3d90-4aa6-9576-971baa4fc5c3","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Error Log"}}]},{"uid":"6792a258-443a-4b21-9c21-52bfa5ea712f","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strFolderErrorLog$\\ErrorLog_$strBatchCode$.txt"}}],"returnTo":{"type":"VARIABLE","variableName":"strFileErrorLog"}},{"uid":"fe23aa98-ae56-4bd3-b141-893b56555b37","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Error Snap"}}]},{"uid":"dbbf5a19-46e0-4a94-b0be-76c5ec789294","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strFolderErrorLog$\\ErrorSnap_$strBatchCode$.png"}}],"returnTo":{"type":"VARIABLE","variableName":"strFileErrorSnap"}},{"uid":"9d6eb330-79a3-408c-a05a-cdb30e0e2d4f","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Archive Folder"}}]},{"uid":"607c67ed-d629-4e2d-88ea-45f127ebb9f8","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"90645446-6520-4635-a5bd-73bd16014f16","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$strFolderArchive$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$strFolderArchive$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"8b3e92fb-cd0f-443b-87c0-ab4239332fe9","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Report Email HTML Body - Header File"}}]},{"uid":"0bc23376-c8cf-4de4-a7a8-565c1fe7e113","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strFolderInput$\\Report Email HTML Body - Header.txt"}}],"returnTo":{"type":"VARIABLE","variableName":"strFileReportEmailHTMLBodyHeader"}},{"uid":"ae90c793-2218-44d8-b261-c177b0e86762","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Report Email HTML Body - Footer File"}}]},{"uid":"e98ece4a-eb23-40dc-aee1-4272de5aaae7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strFolderInput$\\Report Email HTML Body - Footer.txt"}}],"returnTo":{"type":"VARIABLE","variableName":"strFileReportEmailHTMLBodyFooter"}},{"uid":"76f77b96-15f5-4513-8260-802e2de98901","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strFileBotRunLog$"}},{"name":"logContent","value":{"type":"STRING","string":"Creation of necessary folders and files Ends"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Folder and File Creation"}}]},{"uid":"dd141cbc-145c-4140-adee-c23b1453fd2f","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"ac99f21d-7c03-44e2-8ada-82761ce12e27","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"strURLControlRoom","value":{"type":"STRING","expression":"$strURLControlRoom$"}},{"key":"strFileReportEmailHTMLBodyHeader","value":{"type":"STRING","expression":"$strFileReportEmailHTMLBodyHeader$"}},{"key":"strFileReportEmailHTMLBodyFooter","value":{"type":"STRING","expression":"$strFileReportEmailHTMLBodyFooter$"}},{"key":"strFolderInput","value":{"type":"STRING","expression":"$strFolderInput$"}},{"key":"strEmailUser","value":{"type":"STRING","expression":"$strEmailUser$"}},{"key":"strEmailOPSTeam","value":{"type":"STRING","expression":"$strEmailOPSTeam$"}},{"key":"strCompletionEmailSubject","value":{"type":"STRING","expression":"$strCompletionEmailSubject$"}},{"key":"strEmailBot","value":{"type":"STRING","expression":"$strEmailBot$"}},{"key":"strFileBotRunLog","value":{"type":"STRING","expression":"$strFileBotRunLog$"}},{"key":"strFileErrorLog","value":{"type":"STRING","expression":"$strFileErrorLog$"}},{"key":"strFileErrorSnap","value":{"type":"STRING","expression":"$strFileErrorSnap$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/CR%20Monitoring%20Bot/Device%20Connectivity%20Report/Sub%20Bot%20-%20Device%20Connectivity%20Report"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"DICTIONARY","dictionary":[{"key":"boolErrorFlag","value":{"type":"VARIABLE","variableName":"boolErrorFlag"}}]}},{"uid":"72eca53a-eb00-4014-b518-6e5e66538bf7","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"53c088a8-bd85-4121-ab6c-3c82fa193892","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Archiving Error Folder and Log file"}}]},{"uid":"3775d5b9-feb6-4b22-af52-1257c5396073","commandName":"copyFiles","packageName":"File","disabled":false,"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$strFileBotRunLog$"}},{"name":"destinationPath","value":{"type":"STRING","expression":"$strFolderErrorLog$\\"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"112a4e28-7d3d-4ba9-9cec-c1de75498f39","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strFolderArchive$/$strBatchCode$_Logs.zip"}}],"returnTo":{"type":"VARIABLE","variableName":"strFileLogsZip"}},{"uid":"333917fa-6a41-460e-8b6e-4a5df65c6ec9","commandName":"zipFiles","packageName":"Folder","disabled":false,"attributes":[{"name":"sourcePath","value":{"type":"STRING","expression":"$strFolderErrorLog$"}},{"name":"filterType","value":{"type":"STRING","string":"StringValue"}},{"name":"filterExtensions","value":{"type":"STRING","string":""}},{"name":"targetPath","value":{"type":"FILE","expression":"file://$strFileLogsZip$"}},{"name":"isUpdateNewer","value":{"type":"BOOLEAN","boolean":true}},{"name":"isDeleteOriginalFiles","value":{"type":"BOOLEAN","boolean":false}},{"name":"compressionLevel","value":{"type":"STRING","string":"Normal"}},{"name":"password","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]},{"uid":"3b725c8f-f58f-4f9b-b08d-923b0af8dd89","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Adding Error Message in Email Body"}}]},{"uid":"83a4030f-1666-4647-9b00-be02d0e28e9f","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Refer Error Logs"}}],"returnTo":{"type":"VARIABLE","variableName":"strErrorMessage"}},{"uid":"7a3240ab-bcc4-43da-b14f-c328de8a8408","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strHardStopEmailBody$"}},{"name":"find","value":{"type":"STRING","string":"%BotError%"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$strErrorMessage$"}}],"returnTo":{"type":"VARIABLE","variableName":"strHardStopEmailBody"}},{"uid":"4cd31dca-4282-4acb-8499-92d0de19003c","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Adding Machine Name in Email Body"}}]},{"uid":"38c3531b-b9b6-434a-96b1-1cf45993092b","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strHardStopEmailBody$"}},{"name":"find","value":{"type":"STRING","string":"%BOTMachine%"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$System:Machine$"}}],"returnTo":{"type":"VARIABLE","variableName":"strHardStopEmailBody"}},{"uid":"afb22f88-76d1-4761-99d7-61cdc8fd108a","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$strEmailUser$"}},{"name":"cc","value":{"type":"STRING","expression":"$strEmailOPSTeam$"}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","expression":"$strHardStopEmailSubject$"}},{"name":"attachmentsFilePath","value":{"type":"FILE","expression":"file://$strFileLogsZip$"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"$strHardStopEmailBody$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$strEmailBot$"}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"Device Connectivity Report","lockerName":"CR Monitoring Locker","attributeName":"Bot Email Username"}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"Device Connectivity Report","lockerName":"CR Monitoring Locker","attributeName":"Bot Email Password"}}}]},{"uid":"612616e2-73e2-4ee7-8acf-83a6651aab55","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"BOOLEAN","expression":"$boolErrorFlag$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"booleanVariable","packageName":"Boolean"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Device Connectivity Report Bot"}}]}],"branches":[{"uid":"cc355bff-b29e-4071-9832-9f115c1fdd26","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"55ff00cd-78e2-47ec-a6cf-9c55ad9ef493","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$errorMessage$\n$errorLineNumber.Number:toString$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"errorMessage"},"errorLineNumber":{"type":"VARIABLE","variableName":"errorLineNumber"}}}]}],"variables":[{"type":"NUMBER","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false,"name":"SampleNumber"},{"type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false,"name":"SampleString"},{"name":"strStartDate","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"strStartTime","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"strBatchCode","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"strUsername","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"strBotFolder","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"boolErrorFlag","type":"BOOLEAN","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"strFolderLog","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"strErrorMessage","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"strFolderErrorLog","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"strFolderArchive","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"strEmailBot","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"strEmailOPSTeam","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"strEmailUser","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"strStartEmailSubject","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"strStartEmailBody","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"strCompletionEmailSubject","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"strHardStopEmailSubject","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"strHardStopEmailBody","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"dateToday","description":"","type":"DATETIME","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"DATETIME","string":""}},{"name":"strEndDateTime","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"strFolderInput","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"strFileBotRunLog","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"strFileErrorLog","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"strFileErrorSnap","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"strFileReportEmailHTMLBodyFooter","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"strFileReportEmailHTMLBodyHeader","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"strURLControlRoom","type":"STRING","subtype":"UNDEFINED","sessionType":"","input":false,"output":false,"constant":false},{"name":"strFileLogsZip","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"errorMessage","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"errorLineNumber","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}}],"breakpoints":["2b900e1a-d223-4782-b72d-6a810207b21d","38101bbe-f4ed-434f-a7d1-afbc7b48cec7"],"packages":[{"name":"Boolean","version":"2.5.0-20220118-153154"},{"name":"Comment","version":"2.10.0-20220118-153626"},{"name":"Datetime","version":"2.7.0-20220118-153714"},{"name":"Email","version":"3.10.2-20220406-191511"},{"name":"ErrorHandler","version":"2.9.0-20220127-062650"},{"name":"File","version":"6.2.0-20220118-133652"},{"name":"Folder","version":"6.2.0-20220118-133654"},{"name":"If","version":"3.4.0-20220127-062702"},{"name":"LogToFile","version":"3.4.0-20220118-133817"},{"name":"MessageBox","version":"3.3.0-20220118-133818"},{"name":"Number","version":"3.4.0-20220118-133837"},{"name":"Step","version":"2.1.0-20220201-190609"},{"name":"String","version":"5.3.0-20220118-134628"},{"name":"System","version":"3.8.0-20220118-154749"},{"name":"TaskBot","version":"2.3.0-20220127-064009"},{"name":"VBScript","version":"2.13.1-20220207-165826"}],"migrationJournalReviewIds":[],"workItemTemplateName":null,"properties":{"botCodeVersion":"2","improvedNumberSupport":true,"timeout":"0s","automationPriority":"PRIORITY_MEDIUM"}}